<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SignalBridge Dashboard</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/static/style.css">
</head>
<body>
    <div class="container mt-5">
        <div class="language-filter">
            <label for="language-select" class="text-gold">Sprache:</label>
            <select id="language-select" class="form-select">
                <option value="de">Deutsch</option>
                <option value="en">English</option>
            </select>
        </div>
        <h1 class="text-center">SignalBridge Dashboard</h1>
        <div class="nav-tabs-container">

            <div class="overflow-auto">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link active" href="#performance">Performance</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#signalgeber-management">Signalgeber-Management</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#handelshistorie">Handelshistorie</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#equity-guardian">Equity Guardian</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#symbol-einstellungen">Symbol-Einstellungen</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#strategieregeln">Strategieregeln</a>
                    </li>
                </ul>
            </div>

            <div id="performance" class="section">
                <h2>Performance Übersicht</h2>
                <div class="performance-data">
                    <p><strong>Plattform:</strong> {{ performance.platform }}</p>
                    <p><strong>Broker:</strong> {{ performance.broker }}</p>
                    <p><strong>Kontotyp:</strong> {{ performance.account_type }}</p>
                    <p><strong>Initial Balance:</strong> {{ performance.initial_balance }} $</p>
                    <p><strong>Current Balance:</strong> {{ performance.current_balance }} $</p>
                    <p><strong>Total Profit:</strong> {{ performance.total_profit }} $</p>
                    <p><strong>Profit (Month):</strong> {{ performance.monthly_profit }} $</p>
                    <p><strong>Profit (Week):</strong> {{ performance.weekly_profit }} $</p>
                    <p><strong>Profit (Today):</strong> {{ performance.daily_profit }} $</p>
                    <p><strong>Last Update:</strong> {{ performance.last_update }}</p>
                </div>
            </div>

            <div id="signalgeber-management" class="section">
                <h2>Signalgeber Management</h2>
                <table class="table table-dark table-striped">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Risikomanagement</th>
                            <th>TP #</th>
                            <th>SL</th>
                            <th>Andere</th>
                            <th>Pips</th>
                            <th>W/L %</th>
                            <th>Avg. Drawdown</th>
                            <th>Profit</th>
                            <th>Gain</th>
                            <th>Aktionen</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for provider_id, provider_data in signalgeber.items() %}
                        <tr>
                            <td>{{ provider_data.name }}</td>
                            <td>{{ provider_data.risk }}</td>
                            <td>{{ provider_data.tp_count }}</td>
                            <td>{{ provider_data.sl_count }}</td>
                            <td>{{ provider_data.other_count }}</td>
                            <td>{{ provider_data.pips }}</td>
                            <td>{{ provider_data.win_loss }}</td>
                            <td>{{ provider_data.avg_drawdown }}</td>
                            <td>{{ provider_data.profit }}</td>
                            <td>{{ provider_data.gain }}</td>
                            <td>
                                <button class="btn btn-primary btn-sm edit-settings" data-id="{{ provider_id }}" data-bs-toggle="modal" data-bs-target="#settingsModal">⚙️</button>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div id="handelshistorie" class="section-placeholder">
                <h2>Handelshistorie</h2>
                <p>Platzhalter für Handelshistorie.</p>
            </div>
            <div id="equity-guardian" class="section-placeholder">
                <h2>Equity Guardian</h2>
                <p>Platzhalter für Equity-Schutz-Funktionen.</p>
            </div>
            <div id="symbol-settings" class="section-placeholder">
                <h2>Symbol-Einstellungen</h2>
                <p>Platzhalter für Symbol-Konfiguration.</p>
            </div>
            <div id="strategie-regeln" class="section-placeholder">
                <h2>Strategieregeln</h2>
                <p>Platzhalter für Strategieregeln.</p>
            </div>
        </div>
    </div>

    <!-- Modal -->
    <div class="modal fade" id="settingsModal" tabindex="-1" aria-labelledby="settingsModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="settingsModalLabel">Einstellungen</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <ul class="list-group">
                        <li class="list-group-item action-item" data-action="edit-settings">Einstellungen bearbeiten</li>
                        <li class="list-group-item action-item" data-action="signal-analysis">Signal-Analyse</li>
                        <li class="list-group-item action-item" data-action="copy-account">Auf ein anderes Konto kopieren</li>
                        <li class="list-group-item action-item" data-action="settings">Erweiterte Einstellungen</li>
                        <li class="list-group-item action-item" data-action="change-comment">Kommentar ändern</li>
                        <li class="list-group-item action-item" data-action="send-signal">Signal manuell senden</li>
                        <li class="list-group-item action-item" data-action="delete-provider">Provider löschen</li>
                        <li class="list-group-item action-item" data-action="clear-data">Daten bereinigen</li>
                        <li class="list-group-item action-item" data-action="backtest">Backtest durchführen</li>
                    </ul>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Abbrechen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Bootstrap JS-Bibliothek -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>

    <!-- JavaScript -->
    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const actionItems = document.querySelectorAll(".action-item");

            actionItems.forEach(item => {
                item.addEventListener("click", function () {
                    const action = this.getAttribute("data-action");

                    // Aktionen je nach Auswahl
                    switch (action) {
                        case "edit-settings":
                            alert("Einstellungen bearbeiten wurde ausgewählt!");
                            break;
                        case "signal-analysis":
                            alert("Signal-Analyse wurde ausgewählt!");
                            break;
                        case "copy-account":
                            alert("Auf ein anderes Konto kopieren wurde ausgewählt!");
                            break;
                        case "settings":
                            alert("Erweiterte Einstellungen wurde ausgewählt!");
                            break;
                        case "change-comment":
                            alert("Kommentar ändern wurde ausgewählt!");
                            break;
                        case "send-signal":
                            alert("Signal manuell senden wurde ausgewählt!");
                            break;
                        case "delete-provider":
                            if (confirm("Möchten Sie diesen Provider wirklich löschen?")) {
                                alert("Provider wurde gelöscht!");
                            }
                            break;
                        case "clear-data":
                            if (confirm("Möchten Sie die Daten wirklich bereinigen?")) {
                                alert("Daten wurden bereinigt!");
                            }
                            break;
                        case "backtest":
                            alert("Backtest durchführen wurde ausgewählt!");
                            break;
                        default:
                            alert("Unbekannte Aktion!");
                            break;
                    }

                    // Modal schließen nach Auswahl
                    const modal = bootstrap.Modal.getInstance(document.getElementById('settingsModal'));
                    modal.hide();
                });
            });
        });
    </script>
</body>
</html>
