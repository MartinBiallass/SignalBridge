{% extends "base.html" %}

{% block content %}
<h1 id="page-title">Dashboard</h1>
<div class="subscription-status">
    <h2>Abonnement-Status</h2>
    {% if user.orders and user.orders[0].paid_at %}
        <p class="paid">✅ Bezahlt am {{ user.orders[0].paid_at.strftime('%d.%m.%Y %H:%M') }}</p>
    {% else %}
        <p class="unpaid">❌ Dein Abo ist nicht bezahlt!</p>
        <a href="{{ url_for('mock_payment') }}" class="pay-link">Jetzt bezahlen</a>
    {% endif %}
</div>

<div class="menu">
    <a href="{{ url_for('home') }}" class="btn btn-primary">🏠 Startseite</a>
    <a href="{{ url_for('my_payments') }}" class="btn btn-secondary">💳 Meine Zahlungen</a>
    <a href="{{ url_for('account_management') }}" class="btn btn-secondary">🔧 Kontoverwaltung</a>
    <a href="{{ url_for('help_page') }}" class="btn btn-secondary">❓ Hilfe</a>
    <a href="{{ url_for('support') }}" class="btn btn-secondary">🛠️ Support</a>
    <a href="{{ url_for('logout') }}" class="btn btn-warning">🚪 Logout</a>
</div>

<h2>Live Optionstrades</h2>
<table border="1">
    <thead>
        <tr>
            <th>Trade ID</th>
            <th>Typ</th>
            <th>Dauer</th>
        </tr>
    </thead>
    <tbody id="trade-table"></tbody>
</table>

<div class="new-section">
    <h2>Systemstatus</h2>
    <p>📡 Telegram-Status: <span id="telegram-status">Online</span></p>
    <p>🖥️ Server-Status: <span id="server-status">Läuft</span></p>
    <p>🔗 API-Status: <span id="api-status">Verbunden</span></p>
    <p>🛠️ Software-Version: v1.0.0</p>
</div>

<div class="new-section">
    <h2>Nachrichtenverlauf</h2>
    <p>Filter: <input type="text" placeholder="Kanalname"> <input type="date"> <button class="btn btn-secondary">Filtern</button></p>
    <table border="1">
        <thead>
            <tr><th>Datum</th><th>Kanal</th><th>Nachricht</th></tr>
        </thead>
        <tbody><tr><td>14.02.2025</td><td>ForexChannel</td><td>Signal: EUR/USD Buy @1.1000</td></tr></tbody>
    </table>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/4.4.1/socket.io.js"></script>
<script>
    var socket = io.connect("http://" + document.domain + ":" + location.port);
    socket.on("update_trades", function(data) { /* WebSocket Integration */ });
    socket.on("trade_closed", function(data) { /* WebSocket Integration */ });
</script>
{% endblock %}
